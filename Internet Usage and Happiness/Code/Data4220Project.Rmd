---
title: "StatsProject"
author: "Aydan LaCroix and Eric Geisler"
date: "2024-04-15"
output: pdf_document
---

## Reading Data

```{r}
library(readr)
library(epitools)
library(vcd)
library(vcdExtra)
library(ggplot2)
library(dplyr)


df <- read_csv("Documents/responses.csv")
df = na.omit(df)
head(df)
```

## Cleaning Data

```{r}
df$"Internet usage" <- ifelse(df$"Internet usage" %in% c("no time at all", "less than an hour a day"), "Low Usage", df$"Internet usage")
df$"Internet usage" = ifelse(df$"Internet usage" == "few hours a day", "Moderate Usage", df$"Internet usage")
df$"Internet usage" = ifelse(df$"Internet usage" == "most of the day", "High Usage", df$"Internet usage")
```

```{r}
df$"Happiness in life" = ifelse(df$"Happiness in life" == 1, "Very Unhappy", df$"Happiness in life")
df$"Happiness in life" = ifelse(df$"Happiness in life" == 2, "Unhappy", df$"Happiness in life")
df$"Happiness in life" = ifelse(df$"Happiness in life" == 3, "Neither Happy nor Unhappy", df$"Happiness in life")
df$"Happiness in life" = ifelse(df$"Happiness in life" == 4, "Happy", df$"Happiness in life")
df$"Happiness in life" = ifelse(df$"Happiness in life" == 5, "Very Happy", df$"Happiness in life")
```

```{r}
colnames(df)[colnames(df) == "Happiness in life"] <- "LifeHappiness"
colnames(df)[colnames(df) == "Internet usage"] <- "InternetUsage"
```

```{r}
df$InternetUsage <- factor(df$InternetUsage, levels = c("Low Usage", "Moderate Usage", "High Usage"))
df$LifeHappiness <- factor(df$LifeHappiness, levels = c("Very Unhappy", "Unhappy", "Neither Happy nor Unhappy", "Happy", "Very Happy"))
```

## Creating a Contingency Table

```{r}
table = table(df$InternetUsage, df$LifeHappiness)
table
```

## Data Visualization

```{r}
ggplot(df, aes(x = InternetUsage, fill = LifeHappiness)) +
  geom_bar(position = "dodge") +
  labs(x = "Internet Usage", y = "Count", fill = "Happiness with Life") +
  ggtitle("Count of Happiness Levels by Internet Usage")
```

## Conducting a CMH Test

```{r}
results = CMHtest(table)
results
```
Null Hypothesis: internet usage is independent of happiness with life

Conclusion: At the 0.05 level of significance, there is evidence in these data to conclude that there is a linear trend/association between internet usage and happiness with life, as the p-value of .00026 is below .05.

## Analyzing the Residuals

```{r}
psr = chisq.test(table)

psr$stdres
```

## Subtable 1: Low and Moderate Internet Usage

```{r}
df_low_moderate <- df[df$InternetUsage %in% c("Low Usage", "Moderate Usage"), ]
df_low_moderate$InternetUsage <- factor(df_low_moderate$InternetUsage, levels = c("Low Usage", "Moderate Usage"))
table_low_moderate <- table(df_low_moderate$InternetUsage, df_low_moderate$LifeHappiness)

table_low_moderate
```
```{r}
assocstats(table_low_moderate)
```
Null Hypothesis: internet usage is independent of happiness with life

Conclusion: At the 0.05 level of significance, there is no evidence in these data to conclude that internet usage is not independent of happiness with life, as the p-value of .11 is above .05.

```{r}
prob_u_low = 3/95
prob_u_moderate = 32/502
odds_u_low = prob_u_low / (1 - prob_u_low)
odds_u_moderate = prob_u_moderate / (1 - prob_u_moderate)
odds_u_low_mod = odds_u_low / odds_u_moderate
odds_u_low_mod

prob_h_low = 68/95
prob_h_moderate = 329/502
odds_h_low = prob_h_low / (1 - prob_h_low)
odds_h_moderate = prob_h_moderate / (1 - prob_h_moderate)
odds_h_low_mod = odds_h_low / odds_h_moderate
odds_h_low_mod
```

The estimated odds of being unhappy with life while having low internet usage are about .48 times the estimated odds of being unhappy with life while having moderate internet usage.

The estimated odds of being happy with life while having low internet usage are about 1.32 times the estimated odds of being happy with life while having moderate internet usage.

## Subtable 2: Moderate and High Internet Usage

```{r}
df_moderate_high <- df[df$InternetUsage %in% c("Moderate Usage", "High Usage"), ]
df_moderate_high$InternetUsage <- factor(df_moderate_high$InternetUsage, levels = c("Moderate Usage", "High Usage"))
table_moderate_high <- table(df_moderate_high$InternetUsage, df_moderate_high$LifeHappiness)

table_moderate_high
```

```{r}
assocstats(table_moderate_high)
```
Null Hypothesis: internet usage is independent of happiness with life

Conclusion: At the 0.05 level of significance, there is evidence in these data to conclude that internet usage is not independent of happiness with life, as the p-value of .0005 is below .05.

```{r}
prob_u_high = 15/77
odds_u_high = prob_u_high / (1 - prob_u_high)
odds_u_mod_high = odds_u_moderate / odds_u_high
odds_u_mod_high

prob_h_high = 40/77
odds_h_high = prob_h_high/ (1 - prob_h_high)
odds_h_mod_high = odds_h_moderate / odds_h_high
odds_h_mod_high
```

The estimated odds of being unhappy with life while having moderate internet usage are about .28 times the estimated odds of being unhappy with life while having high internet usage.

The estimated odds of being happy with life while having moderate internet usage are about 1.75 times the estimated odds of being happy with life while having high internet usage.

## Subtable 3: Low and High Usage

```{r}
df_low_high <- df[df$InternetUsage %in% c("Low Usage", "High Usage"), ]
df_low_high$InternetUsage <- factor(df_low_high$InternetUsage, levels = c("Low Usage", "High Usage"))
table_low_high <- table(df_low_high$InternetUsage, df_low_high$LifeHappiness)

table_low_high
```

```{r}
assocstats(table_low_high)
```
Null Hypothesis: internet usage is independent of happiness with life

Conclusion: At the 0.05 level of significance, there is evidence in these data to conclude that internet usage is not independent of happiness with life, as the p-value of .0004 is below .05.

```{r}
odds_u_low_high = odds_u_low / odds_u_high
odds_u_low_high

odds_h_low_high = odds_h_low / odds_h_high
odds_h_low_high
```

The estimated odds of being unhappy with life while having low internet usage are about .13 times the estimated odds of being unhappy with life while having high internet usage.

The estimated odds of being happy with life while having low internet usage are about 2.33 times the estimated odds of being happy with life while having high internet usage.











